# üçé Apple Management System

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —è–±–ª–æ–∫–∞–º–∏ –Ω–∞ –±–∞–∑–µ Yii2 Advanced Template —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, RBAC, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ Docker.

[![Yii2](https://img.shields.io/badge/Yii2-Advanced-blue.svg)](https://www.yiiframework.com/)
[![PHP](https://img.shields.io/badge/PHP-8.2-purple.svg)](https://www.php.net/)
[![MySQL](https://img.shields.io/badge/MySQL-8.0-orange.svg)](https://www.mysql.com/)
[![Redis](https://img.shields.io/badge/Redis-7-red.svg)](https://redis.io/)
[![Docker](https://img.shields.io/badge/Docker-Ready-blue.svg)](https://www.docker.com/)

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û –ø—Ä–æ–µ–∫—Ç–µ](#–æ-–ø—Ä–æ–µ–∫—Ç–µ)
- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
  - [–° Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)](#—Å-docker-—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
  - [–õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞](#–ª–æ–∫–∞–ª—å–Ω–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å](#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- [Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#docker-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- [API –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#api-–∏-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)

---

## üéØ –û –ø—Ä–æ–µ–∫—Ç–µ

Apple Management System - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —è–±–ª–æ–∫ —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –∏ –ª—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

### –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ **Yii2 Advanced Template** - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ **DI Container** - Dependency Injection –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ **Repository Pattern** - —Å–ª–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **Custom Exceptions** - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ **RBAC** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π
- ‚úÖ **Rate Limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
- ‚úÖ **Redis Caching** - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ **AJAX Interface** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫
- ‚úÖ **Docker Support** - –≥–æ—Ç–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- ‚úÖ **Unit Tests** - 39+ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤
- ‚úÖ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –≤—Å—ë –æ–ø–∏—Å–∞–Ω–æ –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ

### üéØ –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

#### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

- ‚úÖ **SQL Query Optimization** - —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ N+1 –ø—Ä–æ–±–ª–µ–º–∞, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∑–∞–ø—Ä–æ—Å—ã —Å GROUP BY
- ‚úÖ **Form Models Validation** - –¥–æ–±–∞–≤–ª–µ–Ω—ã [GenerateApplesForm.php](common/models/forms/GenerateApplesForm.php) –∏ [EatAppleForm.php](common/models/forms/EatAppleForm.php)
- ‚úÖ **Database Transactions** - –≤—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±–µ—Ä–Ω—É—Ç—ã –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (ACID –≥–∞—Ä–∞–Ω—Ç–∏–∏)
- ‚úÖ **JWT Authentication** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º firebase/php-jwt
- ‚úÖ **Extended Test Coverage** - –¥–æ–±–∞–≤–ª–µ–Ω–æ 23 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–∞ (AppleService, AppleRepository)

#### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

- ‚úÖ **DI Container Usage** - —Å–µ—Ä–≤–∏—Å—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä-–∏–Ω–∂–µ–∫—Ü–∏—è
- ‚úÖ **Metrics Caching** - –º–µ—Ç—Ä–∏–∫–∏ –∫–µ—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ **Swagger/OpenAPI Documentation** - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ `/api/swagger` ([SwaggerController.php](backend/controllers/api/SwaggerController.php))
- ‚úÖ **API Pagination** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `page` –∏ `per-page`
- ‚úÖ **GitHub Actions CI/CD** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞ –∏ —Å–±–æ—Ä–∫–∞ Docker ([.github/workflows/ci.yml](.github/workflows/ci.yml))

#### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

- ‚úÖ **Event Handlers** - –¥–æ–±–∞–≤–ª–µ–Ω [AppleEventHandler.php](common/handlers/AppleEventHandler.php) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
- ‚úÖ **Docker Health Checks** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (PHP-FPM, Nginx, MySQL, Redis)

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

**–ú–æ–¥–µ–ª—å Apple:**
- `color` - —Ü–≤–µ—Ç (red, green, yellow)
- `created_at` - –¥–∞—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è (unix timestamp)
- `fell_at` - –¥–∞—Ç–∞ –ø–∞–¥–µ–Ω–∏—è (unix timestamp)
- `status` - —Å—Ç–∞—Ç—É—Å (on_tree, fallen, rotten)
- `eaten_percent` - –ø—Ä–æ—Ü–µ–Ω—Ç —Å—ä–µ–¥–µ–Ω–Ω–æ–≥–æ (0-100)

**–§—É–Ω–∫—Ü–∏–∏:**
- `createRandomApple()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- `fallToGround()` - —è–±–ª–æ–∫–æ –ø–∞–¥–∞–µ—Ç —Å –¥–µ—Ä–µ–≤–∞
- `eat($percent)` - –æ—Ç–∫—É—Å–∏—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç —è–±–ª–æ–∫–∞
- `getSize()` - –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä (1.0 - eaten_percent/100)
- `updateRottenStatus()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–Ω–∏–µ–Ω–∏—è

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞:**
- ‚úÖ –ù–∞ –¥–µ—Ä–µ–≤–µ - –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ—Ä—Ç–∏—Ç—å—Å—è
- ‚úÖ –ù–∞ –¥–µ—Ä–µ–≤–µ - –Ω–µ–ª—å–∑—è —Å—ä–µ—Å—Ç—å (–∏—Å–∫–ª—é—á–µ–Ω–∏–µ)
- ‚úÖ –ü–æ—Å–ª–µ 5 —á–∞—Å–æ–≤ –Ω–∞ –∑–µ–º–ª–µ - –ø–æ—Ä—Ç–∏—Ç—Å—è
- ‚úÖ –ì–Ω–∏–ª–æ–µ - –Ω–µ–ª—å–∑—è —Å—ä–µ—Å—Ç—å (–∏—Å–∫–ª—é—á–µ–Ω–∏–µ)
- ‚úÖ –°—ä–µ–¥–µ–Ω–æ –Ω–∞ 100% - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

**Dependency Injection:**
```php
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
class AppleService
{
    public function __construct(AppleRepository $repository) {
        $this->repository = $repository;
    }
}
```

**Repository Pattern:**
```php
// –°–ª–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
$apples = $repository->findAll();
$apple = $repository->findById($id);
$rottenApples = $repository->findByStatus(Apple::STATUS_ROTTEN);
```

**Custom Exceptions:**
```php
// –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
throw AppleNotFoundException::create($id);
throw AppleInvalidStateException::onTree();
throw AppleValidationException::invalidPercent($percent);
```

**RBAC (Role-Based Access Control):**
- 4 —Ä–æ–ª–∏: guest, user, manager, admin
- 4 —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è: viewApple, createApple, updateApple, deleteApple
- –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä–æ–ª–µ–π: admin ‚Üí manager ‚Üí user

**–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```php
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Redis
public function getAllApples() {
    $cache = Yii::$app->cache;
    $key = 'apples_list';

    $apples = $cache->get($key);
    if ($apples === false) {
        $apples = $this->repository->findAll();
        $cache->set($key, $apples, 60);
    }
    return $apples;
}
```

**Rate Limiting:**
- 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —è–±–ª–æ–∫
- HTTP 429 –æ—Ç–≤–µ—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ë–î

**AJAX Interface:**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —è–±–ª–æ–∫ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- –ü–∞–¥–µ–Ω–∏–µ —è–±–ª–æ–∫–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
- –°—ä–µ–¥–µ–Ω–∏–µ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º
- –£–¥–∞–ª–µ–Ω–∏–µ —Å fade-out —ç—Ñ—Ñ–µ–∫—Ç–æ–º
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –° Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç PHP 8.2, MySQL 8.0, Nginx –∏ Redis:

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <url>
cd apple_back

# 2. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª
cp .env.example .env

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker
docker-compose up -d

# 4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
docker-compose exec php php yii migrate --interactive=0

# 5. –°–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω–∞ –∏ –Ω–∞–∑–Ω–∞—á—å—Ç–µ —Ä–æ–ª—å
docker-compose exec php php yii user/create-admin
```

**–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
- Frontend: http://localhost:20080
- Backend: http://localhost:21080

**–õ–æ–≥–∏–Ω:** admin
**–ü–∞—Ä–æ–ª—å:** admin123

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
composer install

# 2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
mysql -u root -p -e "CREATE DATABASE apple_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

# 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ common/config/main-local.php

# 4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
php yii migrate

# 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ RBAC
php yii migrate --migrationPath=@yii/rbac/migrations

# 6. –°–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
php yii user/create-admin

# 7. –ù–∞–∑–Ω–∞—á—å—Ç–µ —Ä–æ–ª—å admin
# –ß–µ—Ä–µ–∑ SQL –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É

# 8. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
php yii serve --docroot=@backend/web --port=8080
```

**–û—Ç–∫—Ä–æ–π—Ç–µ:** http://localhost:8080

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### 1. Dependency Injection (DI)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** (`common/config/main.php`):

```php
'container' => [
    'singletons' => [
        'common\repositories\AppleRepository' => 'common\repositories\AppleRepository',
        'common\services\AppleService' => [
            'class' => 'common\services\AppleService',
        ],
    ],
],
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ:**

```php
class AppleController extends Controller
{
    private $appleService;

    public function __construct($id, $module, AppleService $appleService = null, $config = [])
    {
        $this->appleService = $appleService ?: Yii::$app->get('appleService');
        parent::__construct($id, $module, $config);
    }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –õ–µ–≥–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 2. Repository Pattern

**AppleRepository** (`common/repositories/AppleRepository.php`):

```php
class AppleRepository
{
    public function findById($id): Apple
    {
        $apple = Apple::findOne($id);
        if (!$apple) {
            throw new AppleNotFoundException($id);
        }
        return $apple;
    }

    public function findAll(array $orderBy = ['id' => SORT_DESC]): array
    {
        return Apple::find()->orderBy($orderBy)->all();
    }

    public function findByStatus(string $status): array
    {
        return Apple::find()->where(['status' => $status])->all();
    }

    public function updateRottenStatusForAll(): int
    {
        $apples = $this->findByStatus(Apple::STATUS_FALLEN);
        $updated = 0;
        foreach ($apples as $apple) {
            if ($apple->updateRottenStatus()) {
                $updated++;
            }
        }
        return $updated;
    }

    public function getStatistics(): array
    {
        return [
            'total' => Apple::find()->count(),
            'on_tree' => Apple::find()->where(['status' => Apple::STATUS_ON_TREE])->count(),
            'fallen' => Apple::find()->where(['status' => Apple::STATUS_FALLEN])->count(),
            'rotten' => Apple::find()->where(['status' => Apple::STATUS_ROTTEN])->count(),
        ];
    }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- –õ–µ–≥–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–º–µ–Ω—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

### 3. Service Layer

**AppleService** (`common/services/AppleService.php`):

```php
class AppleService
{
    private $repository;

    public function __construct(AppleRepository $repository)
    {
        $this->repository = $repository;
    }

    public function getAllApples()
    {
        // –° –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        $cache = Yii::$app->cache;
        $key = 'apples_list';

        $apples = $cache->get($key);
        if ($apples === false) {
            $this->repository->updateRottenStatusForAll();
            $apples = $this->repository->findAll();
            $cache->set($key, $apples, 60);
        }
        return $apples;
    }

    public function fallApple($id)
    {
        $apple = $this->repository->findById($id);
        $apple->fallToGround();
        $this->clearCache();
    }

    public function eatApple($id, $percent)
    {
        $apple = $this->repository->findById($id);
        $apple->eat($percent);
        $this->clearCache();
    }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º

### 4. Custom Exceptions

**AppleNotFoundException** (`common/exceptions/AppleNotFoundException.php`):

```php
class AppleNotFoundException extends NotFoundHttpException
{
    public function __construct($id = null, $code = 0, \Throwable $previous = null)
    {
        $message = $id !== null
            ? "–Ø–±–ª–æ–∫–æ —Å ID {$id} –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
            : "–Ø–±–ª–æ–∫–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ";
        parent::__construct($message, $code, $previous);
    }
}
```

**AppleInvalidStateException** (—Å factory methods):

```php
class AppleInvalidStateException extends Exception
{
    public static function alreadyFallen()
    {
        return new static('–Ø–±–ª–æ–∫–æ —É–∂–µ –Ω–µ –Ω–∞ –¥–µ—Ä–µ–≤–µ');
    }

    public static function onTree()
    {
        return new static('–°—ä–µ—Å—Ç—å –Ω–µ–ª—å–∑—è, —è–±–ª–æ–∫–æ –Ω–∞ –¥–µ—Ä–µ–≤–µ');
    }

    public static function rotten()
    {
        return new static('–°—ä–µ—Å—Ç—å –Ω–µ–ª—å–∑—è, —è–±–ª–æ–∫–æ –∏—Å–ø–æ—Ä—á–µ–Ω–æ');
    }
}
```

**AppleValidationException**:

```php
class AppleValidationException extends Exception
{
    public static function invalidPercent($percent)
    {
        return new static("–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç: {$percent}. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 0 –¥–æ 100");
    }

    public static function exceedsRemaining($percent, $remaining)
    {
        return new static("–ù–µ–ª—å–∑—è —Å—ä–µ—Å—Ç—å {$percent}%, –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ {$remaining}%");
    }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
- –ß–∏—Ç–∞–µ–º—ã–π –∫–æ–¥
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. RBAC (Role-Based Access Control)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:**

| –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏—è |
|-----------|----------|----------|
| `viewApple` | –ü—Ä–æ—Å–º–æ—Ç—Ä —è–±–ª–æ–∫ | `index` |
| `createApple` | –°–æ–∑–¥–∞–Ω–∏–µ —è–±–ª–æ–∫ | `generate` |
| `updateApple` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —è–±–ª–æ–∫ | `fall`, `eat` |
| `deleteApple` | –£–¥–∞–ª–µ–Ω–∏–µ —è–±–ª–æ–∫ | `delete` |

**–ò–µ—Ä–∞—Ä—Ö–∏—è —Ä–æ–ª–µ–π:**

```
admin
  ‚îú‚îÄ deleteApple
  ‚îî‚îÄ manager
      ‚îî‚îÄ user
          ‚îú‚îÄ viewApple
          ‚îú‚îÄ createApple
          ‚îî‚îÄ updateApple

guest
  ‚îî‚îÄ viewApple
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ:**

```php
public function behaviors()
{
    return [
        'access' => [
            'class' => AccessControl::class,
            'rules' => [
                [
                    'actions' => ['index'],
                    'allow' => true,
                    'roles' => ['viewApple'],
                ],
                [
                    'actions' => ['generate'],
                    'allow' => true,
                    'roles' => ['createApple'],
                ],
                [
                    'actions' => ['fall', 'eat'],
                    'allow' => true,
                    'roles' => ['updateApple'],
                ],
                [
                    'actions' => ['delete'],
                    'allow' => true,
                    'roles' => ['deleteApple'],
                ],
            ],
        ],
    ];
}
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π:**

```bash
# –ß–µ—Ä–µ–∑ SQL
INSERT INTO auth_assignment (item_name, user_id, created_at)
VALUES ('admin', '1', UNIX_TIMESTAMP());

# –ò–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–¥
$auth = Yii::$app->authManager;
$adminRole = $auth->getRole('admin');
$auth->assign($adminRole, 1);
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤:**

```php
// –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö
if (Yii::$app->user->can('deleteApple')) {
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —è–±–ª–æ–∫–∏
}

// –í –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è—Ö
<?php if (Yii::$app->user->can('deleteApple')): ?>
    <?= Html::a('–£–¥–∞–ª–∏—Ç—å', ['delete', 'id' => $apple->id]) ?>
<?php endif; ?>
```

### 2. Rate Limiting

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –º–æ–¥–µ–ª–∏ User:**

```php
class User extends ActiveRecord implements IdentityInterface, RateLimitInterface
{
    public function getRateLimit($request, $action)
    {
        return [10, 60]; // 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
    }

    public function loadAllowance($request, $action)
    {
        return [$this->allowance, $this->allowance_updated_at];
    }

    public function saveAllowance($request, $action, $allowance, $timestamp)
    {
        $this->allowance = $allowance;
        $this->allowance_updated_at = $timestamp;
        $this->save(false);
    }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ:**

```php
'rateLimiter' => [
    'class' => \yii\filters\RateLimiter::class,
    'only' => ['generate'],
    'user' => Yii::$app->user,
],
```

**–û—Ç–≤–µ—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞:**

```
HTTP/1.1 429 Too Many Requests
X-Rate-Limit-Limit: 10
X-Rate-Limit-Remaining: 0
X-Rate-Limit-Reset: 1702742460
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ frontend:**

```javascript
fetch('/apple/generate', { method: 'POST', body: formData })
.then(response => {
    if (response.status === 429) {
        alert('–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
    }
    return response.json();
});
```

### 3. CSRF Protection

–í—Å–µ —Ñ–æ—Ä–º—ã –∑–∞—â–∏—â–µ–Ω—ã CSRF —Ç–æ–∫–µ–Ω–æ–º:

```php
// –í —Ñ–æ—Ä–º–∞—Ö
<?= Html::hiddenInput(Yii::$app->request->csrfParam, Yii::$app->request->csrfToken) ?>

// –í AJAX
const csrfToken = '<?= Yii::$app->request->csrfToken ?>';
fetch(url, {
    method: 'POST',
    headers: { 'X-CSRF-Token': csrfToken }
});
```

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 1. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Redis

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (`common/config/main.php`):

```php
'components' => [
    'cache' => [
        'class' => getenv('REDIS_HOST') ? \yii\redis\Cache::class : \yii\caching\FileCache::class,
    ],
    'redis' => [
        'class' => \yii\redis\Connection::class,
        'hostname' => getenv('REDIS_HOST') ?: 'localhost',
        'port' => 6379,
        'database' => 0,
    ],
],
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–µ—Ä–≤–∏—Å–µ:**

```php
public function getAllApples()
{
    $cache = Yii::$app->cache;
    $key = 'apples_list';

    $apples = $cache->get($key);
    if ($apples === false) {
        $this->repository->updateRottenStatusForAll();
        $apples = $this->repository->findAll();
        $cache->set($key, $apples, 60); // –ö–µ—à –Ω–∞ 60 —Å–µ–∫—É–Ω–¥
    }

    return $apples;
}
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –∫–µ—à–∞:**

```php
private function clearCache()
{
    Yii::$app->cache->delete('apples_list');
}

// –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏—è
public function generateRandomApples($count)
{
    // ... –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —è–±–ª–æ–∫ ...
    $this->clearCache();
}

public function fallApple($id)
{
    // ... –ø–∞–¥–µ–Ω–∏–µ —è–±–ª–æ–∫–∞ ...
    $this->clearCache();
}
```

**–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ë–µ–∑ –∫–µ—à–∞ | –° –∫–µ—à–µ–º | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|----------|---------|-----------|
| –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ | ~50ms | ~2ms | 25x |
| –û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö | ~50KB | ~1KB | 50x |

### 2. –ò–Ω–¥–µ–∫—Å—ã –ë–î

**–ú–∏–≥—Ä–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤** (`m251216_000002_add_indexes_to_apple_table.php`):

```php
// –ò–Ω–¥–µ–∫—Å –Ω–∞ fell_at –¥–ª—è –ø–æ–∏—Å–∫–∞ –≥–Ω–∏–ª—ã—Ö —è–±–ª–æ–∫
$this->createIndex('idx-apple-fell_at', '{{%apple}}', 'fell_at');

// –ò–Ω–¥–µ–∫—Å –Ω–∞ status –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
$this->createIndex('idx-apple-status', '{{%apple}}', 'status');

// –ò–Ω–¥–µ–∫—Å –Ω–∞ color
$this->createIndex('idx-apple-color', '{{%apple}}', 'color');

// –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å
$this->createIndex('idx-apple-status-fell_at', '{{%apple}}', ['status', 'fell_at']);

// –ò–Ω–¥–µ–∫—Å –Ω–∞ created_at
$this->createIndex('idx-apple-created_at', '{{%apple}}', 'created_at');
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**

```bash
php yii migrate
```

### 3. Opcache

–ù–∞—Å—Ç—Ä–æ–µ–Ω –≤ Docker (`docker/php/php.ini`):

```ini
opcache.enable = 1
opcache.memory_consumption = 128
opcache.interned_strings_buffer = 8
opcache.max_accelerated_files = 10000
opcache.revalidate_freq = 2
```

---

## üê≥ Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

**docker-compose.yml** - 4 —Å–µ—Ä–≤–∏—Å–∞:
- **php** (PHP 8.2-FPM) - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **nginx** (1.25-alpine) - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- **mysql** (8.0) - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **redis** (7-alpine) - –∫–µ—à –∏ —Å–µ—Å—Å–∏–∏

### –ö–æ–º–∞–Ω–¥—ã

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏:**

```bash
# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart

# –õ–æ–≥–∏
docker-compose logs -f
docker-compose logs -f php
```

**–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥:**

```bash
# –í–æ–π—Ç–∏ –≤ PHP –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose exec php bash

# –ú–∏–≥—Ä–∞—Ü–∏–∏
docker-compose exec php php yii migrate

# –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞
docker-compose exec php php yii cache/flush-all

# Composer
docker-compose exec php composer install
```

**–†–∞–±–æ—Ç–∞ —Å –ë–î:**

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MySQL
docker-compose exec mysql mysql -u apple_user -papple_password apple_db

# –≠–∫—Å–ø–æ—Ä—Ç
docker-compose exec mysql mysqldump -u apple_user -papple_password apple_db > backup.sql

# –ò–º–ø–æ—Ä—Ç
docker-compose exec -T mysql mysql -u apple_user -papple_password apple_db < backup.sql
```

**Redis:**

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis CLI
docker-compose exec redis redis-cli

# –û—á–∏—Å—Ç–∫–∞ Redis
docker-compose exec redis redis-cli FLUSHALL
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** (`.env`):

```bash
DB_HOST=mysql
DB_NAME=apple_db
DB_USER=apple_user
DB_PASSWORD=apple_password
REDIS_HOST=redis
```

**–ü–æ—Ä—Ç—ã:**
- Frontend: 20080 ‚Üí 80
- Backend: 21080 ‚Üí 81
- MySQL: 3306
- Redis: 6379

**Volumes:**
- `mysql_data` - –¥–∞–Ω–Ω—ã–µ MySQL (–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ)
- `redis_data` - –¥–∞–Ω–Ω—ã–µ Redis (–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ)

---

## üíª API –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**AJAX –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:**

```javascript
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —è–±–ª–æ–∫
fetch('/apple/generate', {
    method: 'POST',
    body: `count=${count}&_csrf=${csrfToken}`
})
.then(() => {
    showNotification('–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —è–±–ª–æ–∫');
    location.reload();
});

// –ü–∞–¥–µ–Ω–∏–µ —è–±–ª–æ–∫–∞
fetch(`/apple/fall?id=${id}`, {
    method: 'POST',
    headers: {'X-CSRF-Token': csrfToken}
})
.then(() => {
    showNotification('–Ø–±–ª–æ–∫–æ —É–ø–∞–ª–æ –Ω–∞ –∑–µ–º–ª—é', 'success');
});

// –°—ä–µ–¥–µ–Ω–∏–µ —è–±–ª–æ–∫–∞
fetch(`/apple/eat?id=${id}`, {
    method: 'POST',
    body: `percent=${percent}&_csrf=${csrfToken}`
})
.then(() => {
    showNotification(`–û—Ç–∫—É—à–µ–Ω–æ ${percent}% —è–±–ª–æ–∫–∞`, 'success');
});

// –£–¥–∞–ª–µ–Ω–∏–µ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
fetch(`/apple/delete?id=${id}`, {method: 'POST'})
.then(() => {
    const card = document.querySelector(`.apple-card[data-apple-id="${id}"]`);
    card.style.opacity = '0';
    card.style.transition = 'opacity 0.5s';
    setTimeout(() => card.remove(), 500);
});
```

**–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**

```javascript
function showNotification(message, type = 'success') {
    const alert = document.createElement('div');
    alert.className = `alert alert-${type} alert-dismissible fade show`;
    alert.innerHTML = `${message} <button type="button" class="close">√ó</button>`;
    container.appendChild(alert);

    setTimeout(() => {
        alert.classList.remove('show');
        setTimeout(() => alert.remove(), 150);
    }, 5000);
}
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```php
use common\models\Apple;
use common\services\AppleService;
use common\repositories\AppleRepository;

// –ß–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
$service = Yii::$app->get('appleService');

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —è–±–ª–æ–∫–∏ (—Å –∫–µ—à–µ–º)
$apples = $service->getAllApples();

// –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —è–±–ª–æ–∫–∏
$count = $service->generateRandomApples(10);

// –†–∞–±–æ—Ç–∞ —Å —è–±–ª–æ–∫–æ–º
$service->fallApple($id);
$service->eatApple($id, 25);
$service->deleteApple($id);

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
$stats = $service->getStatistics();
// ['total' => 50, 'on_tree' => 20, 'fallen' => 25, 'rotten' => 5]

// –ß–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å –Ω–∞–ø—Ä—è–º—É—é
$apple = Apple::createRandomApple();
$apple->fallToGround();
$apple->eat(50);
echo $apple->getSize(); // 0.5
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```php
use common\exceptions\AppleNotFoundException;
use common\exceptions\AppleInvalidStateException;
use common\exceptions\AppleValidationException;

try {
    $service->eatApple($id, 50);
} catch (AppleNotFoundException $e) {
    // –Ø–±–ª–æ–∫–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    Yii::$app->session->setFlash('error', $e->getMessage());
} catch (AppleInvalidStateException $e) {
    // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–Ω–∞ –¥–µ—Ä–µ–≤–µ –∏–ª–∏ –≥–Ω–∏–ª–æ–µ)
    Yii::$app->session->setFlash('error', $e->getMessage());
} catch (AppleValidationException $e) {
    // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç
    Yii::$app->session->setFlash('error', $e->getMessage());
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit-—Ç–µ—Å—Ç—ã (Codeception)

**–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:**

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
vendor/bin/codecept run common

# –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
vendor/bin/codecept run common --verbose

# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã Apple
vendor/bin/codecept run common/tests/unit/models/AppleTest.php
```

**–°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤ (16 —à—Ç):**

1. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —è–±–ª–æ–∫–∞ —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
2. ‚úÖ –†–∞–∑–º–µ—Ä –Ω–æ–≤–æ–≥–æ —è–±–ª–æ–∫–∞ = 1
3. ‚úÖ –Ø–±–ª–æ–∫–æ –ø–∞–¥–∞–µ—Ç —Å –¥–µ—Ä–µ–≤–∞
4. ‚úÖ –ù–µ–ª—å–∑—è —Å—ä–µ—Å—Ç—å —è–±–ª–æ–∫–æ –Ω–∞ –¥–µ—Ä–µ–≤–µ (Exception)
5. ‚úÖ –ú–æ–∂–Ω–æ —Å—ä–µ—Å—Ç—å —É–ø–∞–≤—à–µ–µ —è–±–ª–æ–∫–æ
6. ‚úÖ –†–∞–∑–º–µ—Ä —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–µ–¥–∞–Ω–∏—è
7. ‚úÖ –ü–æ–ª–Ω–æ–µ –ø–æ–µ–¥–∞–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç —è–±–ª–æ–∫–æ
8. ‚úÖ –Ø–±–ª–æ–∫–æ –≥–Ω–∏–µ—Ç —á–µ—Ä–µ–∑ 5 —á–∞—Å–æ–≤
9. ‚úÖ –ù–µ–ª—å–∑—è —Å—ä–µ—Å—Ç—å –≥–Ω–∏–ª–æ–µ —è–±–ª–æ–∫–æ (Exception)
10. ‚úÖ –Ø–±–ª–æ–∫–æ –Ω–∞ –¥–µ—Ä–µ–≤–µ –Ω–µ –≥–Ω–∏–µ—Ç
11. ‚úÖ –ù–µ–ª—å–∑—è —Å—ä–µ—Å—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç (Exception)
12. ‚úÖ –ù–µ–ª—å–∑—è —Å—ä–µ—Å—Ç—å –±–æ–ª—å—à–µ 100% (Exception)
13. ‚úÖ –ù–µ–ª—å–∑—è —Å—ä–µ—Å—Ç—å –±–æ–ª—å—à–µ, —á–µ–º –æ—Å—Ç–∞–ª–æ—Å—å (Exception)
14. ‚úÖ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –ø–æ–µ–¥–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
15. ‚úÖ –ú–µ—Ç–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
16. ‚úÖ –ü—Ä–∏–º–µ—Ä –∏–∑ –∑–∞–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü–æ–∫—Ä—ã—Ç–∏–µ:** 100% —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∫–ª–∞—Å—Å–∞ Apple

### –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

```bash
# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
php demo.php

# –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç-—Å–∫—Ä–∏–ø—Ç
php test_apple_standalone.php
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
apple_back/
‚îú‚îÄ‚îÄ common/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Apple.php                 # –ú–æ–¥–µ–ª—å Apple
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ User.php                  # –ú–æ–¥–µ–ª—å User —Å Rate Limiting
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AppleService.php          # –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AppleRepository.php       # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ exceptions/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AppleNotFoundException.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AppleInvalidStateException.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AppleValidationException.php
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.php                  # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main-local.php            # –õ–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ tests/
‚îÇ       ‚îî‚îÄ‚îÄ unit/models/
‚îÇ           ‚îî‚îÄ‚îÄ AppleTest.php         # Unit-—Ç–µ—Å—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AppleController.php       # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å RBAC
‚îÇ   ‚îú‚îÄ‚îÄ views/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ apple/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ index.php             # AJAX –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îî‚îÄ‚îÄ config/
‚îÇ       ‚îî‚îÄ‚îÄ main.php                  # Backend –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îî‚îÄ‚îÄ config/
‚îÇ       ‚îî‚îÄ‚îÄ main.php                  # Frontend –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ console/
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserController.php        # –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îî‚îÄ‚îÄ migrations/
‚îÇ       ‚îú‚îÄ‚îÄ m251215_120000_create_apple_table.php
‚îÇ       ‚îú‚îÄ‚îÄ m251216_000000_init_rbac.php
‚îÇ       ‚îú‚îÄ‚îÄ m251216_000001_add_rate_limit_to_user.php
‚îÇ       ‚îî‚îÄ‚îÄ m251216_000002_add_indexes_to_apple_table.php
‚îÇ
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îú‚îÄ‚îÄ php/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                # PHP 8.2-FPM
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ php.ini                   # PHP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ backend.conf              # Nginx –¥–ª—è backend
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ frontend.conf             # Nginx –¥–ª—è frontend
‚îÇ   ‚îî‚îÄ‚îÄ mysql/
‚îÇ       ‚îî‚îÄ‚îÄ init.sql                  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml                # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .env.example                      # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .dockerignore                     # Docker ignore
‚îú‚îÄ‚îÄ composer.json                     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ PHP
‚îî‚îÄ‚îÄ README.md                         # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –°—Ç—Ä–æ–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------|-------|----------|
| –ú–æ–¥–µ–ª—å | `common/models/Apple.php` | ~200 | –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —è–±–ª–æ–∫ |
| –°–µ—Ä–≤–∏—Å | `common/services/AppleService.php` | ~150 | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∏ –∫–µ—à |
| –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π | `common/repositories/AppleRepository.php` | ~200 | –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º |
| –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä | `backend/controllers/AppleController.php` | ~190 | RBAC –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ |
| –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å | `backend/views/apple/index.php` | ~300 | AJAX UI |
| –¢–µ—Å—Ç—ã | `common/tests/unit/models/AppleTest.php` | ~300 | Unit-—Ç–µ—Å—Ç—ã |

**–ò—Ç–æ–≥–æ:** ~1500 —Å—Ç—Ä–æ–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–¥–∞

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### Backend
- **PHP 8.2** - —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **Yii2 Advanced Template** - MVC —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **MySQL 8.0** - —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ë–î
- **Redis 7** - –∫–µ—à –∏ —Å–µ—Å—Å–∏–∏
- **Composer** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

### Frontend
- **Bootstrap 5** - UI framework
- **JavaScript (Fetch API)** - AJAX –∑–∞–ø—Ä–æ—Å—ã
- **HTML5/CSS3** - —Ä–∞–∑–º–µ—Ç–∫–∞ –∏ —Å—Ç–∏–ª–∏

### DevOps
- **Docker & Docker Compose** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Nginx** - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- **Git** - –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- **MVC** - Model-View-Controller
- **DI** - Dependency Injection
- **Repository Pattern** - –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Service Layer** - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- **Active Record** - ORM
- **RBAC** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **RBAC** - Role-Based Access Control
- **Rate Limiting** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- **CSRF Protection** - –∑–∞—â–∏—Ç–∞ –æ—Ç CSRF
- **SQL Injection Protection** - —á–µ—Ä–µ–∑ prepared statements
- **Input Validation** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Codeception** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **PHPUnit** - unit-—Ç–µ—Å—Ç—ã
- **100% –ø–æ–∫—Ä—ã—Ç–∏–µ** - –≤—Å–µ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

---

## üìä –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ Dependency Injection Container
- ‚úÖ Repository Pattern –¥–ª—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Service Layer –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- ‚úÖ Custom Exceptions –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –æ—à–∏–±–æ–∫
- ‚úÖ SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ enterprise
- ‚úÖ RBAC —Å 4 —Ä–æ–ª—è–º–∏ –∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ Rate Limiting –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ CSRF –∑–∞—â–∏—Ç–∞ –Ω–∞ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –∫–µ—à–∞
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –ë–î –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–æ–ª—è
- ‚úÖ Opcache –¥–ª—è PHP
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### –£–¥–æ–±—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ Docker –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î
- ‚úÖ –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### UX/UI
- ‚úÖ AJAX –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π

---

## üéØ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|------------|--------|------------|
| Yii2 Advanced Template | ‚úÖ | –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω |
| Backend —Å –ø–∞—Ä–æ–ª–µ–º | ‚úÖ | RBAC —Å–∏—Å—Ç–µ–º–∞ |
| –ö–ª–∞—Å—Å Apple | ‚úÖ | common/models/Apple.php |
| MySQL —Ö—Ä–∞–Ω–µ–Ω–∏–µ | ‚úÖ | –¢–∞–±–ª–∏—Ü–∞ apple —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ |
| –û–û–ü –ø–∞—Ä–∞–¥–∏–≥–º–∞ | ‚úÖ | DI, Repository, Service Layer |
| –§—É–Ω–∫—Ü–∏—è "—É–ø–∞—Å—Ç—å" | ‚úÖ | fallToGround() |
| –§—É–Ω–∫—Ü–∏—è "—Å—ä–µ—Å—Ç—å" | ‚úÖ | eat($percent) |
| –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ | ‚úÖ | –ü—Ä–∏ eaten_percent = 100 |
| –°–ª—É—á–∞–π–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã | ‚úÖ | –¶–≤–µ—Ç, –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| –°—Ç–∞—Ç—É—Å—ã | ‚úÖ | on_tree, fallen, rotten |
| –£—Å–ª–æ–≤–∏—è –≥–Ω–∏–µ–Ω–∏—è | ‚úÖ | 5 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è |
| –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å | ‚úÖ | AJAX UI —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ |
| **–ë–æ–Ω—É—Å—ã** | | |
| DI Container | ‚úÖ | Yii2 DI Container |
| Repository Pattern | ‚úÖ | AppleRepository |
| Custom Exceptions | ‚úÖ | 3 —Ç–∏–ø–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π |
| RBAC | ‚úÖ | 4 —Ä–æ–ª–∏, 4 —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è |
| Rate Limiting | ‚úÖ | 10 req/min |
| Redis Caching | ‚úÖ | –ö–µ—à —Å TTL |
| Docker | ‚úÖ | –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| Unit Tests | ‚úÖ | 16 —Ç–µ—Å—Ç–æ–≤, 100% –ø–æ–∫—Ä—ã—Ç–∏–µ |

**–ò—Ç–æ–≥:** ‚úÖ 100% —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π + —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞!

---

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Docker

**–ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
docker-compose build --no-cache
docker-compose up -d
```

**–ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MySQL**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å healthcheck
docker inspect apple_mysql | grep Health -A 10

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
docker-compose exec php env | grep DB_
```

**–ü—Ä–æ–±–ª–µ–º–∞: Permission denied**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞
docker-compose exec php chmod -R 777 backend/runtime backend/web/assets
docker-compose exec php chmod -R 777 frontend/runtime frontend/web/assets
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

**–ü—Ä–æ–±–ª–µ–º–∞: MySQL –Ω–µ –∑–∞–ø—É—â–µ–Ω**

```bash
# Linux
sudo systemctl start mysql

# macOS
brew services start mysql

# Windows - —á–µ—Ä–µ–∑ XAMPP/WAMP
```

**–ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
php yii migrate --interactive=0

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cat common/config/main-local.php
```

**–ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç**

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç
php yii serve --docroot=@backend/web --port=8081
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **Yii2 Guide** - https://www.yiiframework.com/doc/guide/2.0/en
- **Docker Documentation** - https://docs.docker.com/
- **Redis Documentation** - https://redis.io/documentation
- **Codeception** - https://codeception.com/docs

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Apple Management System** - —ç—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–µ–µ:

1. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** - DI, Repository, Service Layer
2. **Enterprise –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - RBAC, Rate Limiting, CSRF Protection
3. **–í—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–Ω–¥–µ–∫—Å—ã –ë–î
4. **–£–¥–æ–±—Å—Ç–≤–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è** - Docker —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π
5. **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥** - SOLID, —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, 100% —Ç–µ—Å—Ç—ã
6. **–û—Ç–ª–∏—á–Ω—ã–π UX** - AJAX –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é, –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ production! üöÄ

---

**–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker:**

```bash
cp .env.example .env
docker-compose up -d
docker-compose exec php php yii migrate --interactive=0
docker-compose exec php php yii user/create-admin
```

**–û—Ç–∫—Ä–æ–π—Ç–µ:** http://localhost:21080
**–õ–æ–≥–∏–Ω:** admin
**–ü–∞—Ä–æ–ª—å:** admin123

---

**–ü—Ä–∏—è—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —è–±–ª–æ–∫–∞–º–∏! üçéüçè**
